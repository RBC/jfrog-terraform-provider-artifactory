---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "artifactory_package_cleanup_policy Resource - terraform-provider-artifactory"
subcategory: "Configuration"
description: |-
  Provides an Artifactory Package Cleanup Policy resource. This resource enable system administrators to define and customize policies based on specific criteria for removing unused binaries from across their JFrog platform. See Rentation Policies https://jfrog.com/help/r/jfrog-platform-administration-documentation/retention-policies for more details.
  ~>Currently in beta and not yet globally available. A full rollout is scheduled for early October 2024.
---

# artifactory_package_cleanup_policy (Resource)

Provides an Artifactory Package Cleanup Policy resource. This resource enable system administrators to define and customize policies based on specific criteria for removing unused binaries from across their JFrog platform. See [Rentation Policies](https://jfrog.com/help/r/jfrog-platform-administration-documentation/retention-policies) for more details.

~>Currently in beta and not yet globally available. A full rollout is scheduled for early October 2024.

## Example Usage

```terraform
resource "artifactory_package_cleanup_policy" "my-cleanup-policy" {
  key = "my-policy"
  description = "My package cleanup policy"
  cron_expression = "0 0 2 ? * MON-SAT *"
  duration_in_minutes = 60
  enabled = true
  skip_trashcan = false
  project_key = "myprojkey"
  
  search_criteria = {
    package_types = [
      "docker",
      "maven",
    ]
    repos = [
      "my-docker-local",
      "my-maven-local",
    ]
    excluded_repos = ["gradle-global"]
    include_all_projects = false
    included_projects = []
    included_packages = ["com/jfrog"]
    excluded_packages = ["com/jfrog/latest"]
    created_before_in_months = 1
    last_downloaded_before_in_months = 6
    keep_last_n_versions = 0
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `key` (String) Policy key. It has to be unique. It should not be used for other policies and configuration entities like archive policies, key pairs, repo layouts, property sets, backups, proxies, reverse proxies etc. A minimum of three characters is required and can include letters, numbers, underscore and hyphen.
- `search_criteria` (Attributes) (see [below for nested schema](#nestedatt--search_criteria))

### Optional

- `cron_expression` (String) The Cron expression that sets the schedule of policy execution. For example, `0 0 2 * * ?` executes the policy every day at 02:00 AM. The minimum recurrent time for policy execution is 6 hours.
- `description` (String)
- `duration_in_minutes` (Number) Enable and select the maximum duration for policy execution. Note: using this setting can cause the policy to stop before completion.
- `enabled` (Boolean) Enables or disabled the package cleanup policy. This allows the user to run the policy manually. If a policy has a valid cron expression, then it will be scheduled for execution based on it. If a policy is disabled, its future executions will be unscheduled. Defaults to `true`
- `project_key` (String) This attribute is used only for project-level cleanup policies, it is not used for global-level policies.
- `skip_trashcan` (Boolean) Enabling this setting results in packages being permanently deleted from Artifactory after the cleanup policy is executed instead of going to the Trash Can repository. Defaults to `false`.

~>The Global Trash Can setting must be enabled if you want deleted items to be transferred to the Trash Can. For information on enabling global Trash Can settings, see [Trash Can Settings](https://jfrog.com/help/r/jfrog-artifactory-documentation/trash-can-settings).

<a id="nestedatt--search_criteria"></a>
### Nested Schema for `search_criteria`

Required:

- `included_packages` (Set of String) Specify a pattern for a package name or an explicit package name. It accept only single element which can be specific package or pattern, and for including all packages use `**`. Example: `included_packages = ["**"]`
- `package_types` (Set of String) Types of packages to be removed. Support: conan, docker, generic, gradle, maven, npm, nuget, rpm.
- `repos` (Set of String) Specify patterns for repository names or explicit repository names. For including all repos use `**`. Example: `repos = ["**"]`

Optional:

- `created_before_in_months` (Number) Remove packages based on when they were created. For example, remove packages that were created more than a year ago. The default value is to remove packages created more than 2 years ago.
- `excluded_packages` (Set of String) Specify explicit package names that you want excluded from the policy. Only Name explicit names (and not patterns) are accepted.
- `excluded_repos` (Set of String) Specify patterns for repository names or explicit repository names that you want excluded from the cleanup policy.
- `include_all_projects` (Boolean) Set this to `true` if you want the policy to run on all projects on the platform.
- `included_projects` (Set of String) List of projects on which you want this policy to run. To include repositories that are not assigned to any project, enter the project key `default`.

~>This setting is relevant only on the global level, for Platform Admins.
- `keep_last_n_versions` (Number) Select the number of latest versions to keep. The cleanup policy will remove all versions prior to the number you select here. The latest version is always excluded. Versions are determined by creation date.

~>Not all package types support this condition. For information on which package types support this condition, [learn more](https://jfrog.com/help/r/jfrog-platform-administration-documentation/retention-policies/package-types-coverage).
- `last_downloaded_before_in_months` (Number) Removes packages based on when they were last downloaded. For example, removes packages that were not downloaded in the past year. The default value is to remove packages that were downloaded more than 2 years ago.

~>If a package was never downloaded, the policy will remove it based only on the age-condition (`created_before_in_months`).

~>JFrog recommends using the `last_downloaded_before_in_months` condition to ensure that packages currently in use are not deleted.

## Import

Import is supported using the following syntax:

```shell
terraform import artifactory_package_cleanup_policy.my-cleanup-policy my-policy

terraform import artifactory_package_cleanup_policy.my-cleanup-policy my-policy:myproj
```
