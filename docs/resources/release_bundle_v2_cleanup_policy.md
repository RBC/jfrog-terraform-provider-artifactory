---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "artifactory_release_bundle_v2_cleanup_policy Resource - terraform-provider-artifactory"
subcategory: "Configuration"
description: |-
  Provides an Artifactory Archive Policy resource. This resource enable system administrators to configure and maintain JFrog cleanup policies for Release Bundles V2. See Cleanup Policies https://jfrog.com/help/r/jfrog-rest-apis/cleanup-policies-release-bundles-v2-apis for more details.
  ~>Release Bundles V2 Cleanup Policies APIs are supported on Artifactory version 7.104.2 and later.
---

# artifactory_release_bundle_v2_cleanup_policy (Resource)

Provides an Artifactory Archive Policy resource. This resource enable system administrators to configure and maintain JFrog cleanup policies for Release Bundles V2. See [Cleanup Policies](https://jfrog.com/help/r/jfrog-rest-apis/cleanup-policies-release-bundles-v2-apis) for more details.

~>Release Bundles V2 Cleanup Policies APIs are supported on Artifactory version 7.104.2 and later.

## Example Usage

```terraform
resource "artifactory_release_bundle_v2" "my-release-bundle-v2-rb" {
  name = "my-release-bundle-v2-rb"
  version = "2.0.0"
  keypair_name = "my-keypair-name"
  skip_docker_manifest_resolution = true
  source_type = "release_bundles"

  source = {
    release_bundles = [{
      name = "my-rb-name"
      version = "1.0.0"
    }]
  }
}

resource "artifactory_release_bundle_v2_cleanup_policy" "my-resource-bundle-v2-cleanup-policy" {
  key = "my-release-bundle-v2-policy-key"
  description = "Cleanup policy description"
  cron_expression = "0 0 2 * * ?"
  duration_in_minutes = 60
  enabled = true
  search_criteria = {
    include_all_projects = true
    included_projects = []
    release_bundles = [
      {
        name = "my-release-bundle-v2-rb"
        project_key = ""
      }
    ]
    exclude_promoted_environments = [
      "**"
    ]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `key` (String) An ID that is used to identify the cleanup policy. A minimum of three characters is required and can include letters, numbers, underscore and hyphen.
- `search_criteria` (Attributes) (see [below for nested schema](#nestedatt--search_criteria))

### Optional

- `cron_expression` (String) The cron expression determines when the policy is run. This parameter is not mandatory, however if left empty the policy will not run automatically and can only be triggered manually.
- `description` (String)
- `duration_in_minutes` (Number) The maximum duration (in minutes) for policy execution, after which the policy will stop running even if not completed. While setting a maximum run duration for a policy is useful for adhering to a strict archive V2 schedule, it can cause the policy to stop before completion.
- `enabled` (Boolean) Enables or disabled the release bundles v2 cleanup policy. This allows the user to run the policy manually. If a policy has a valid cron expression, then it will be scheduled for execution based on it. If a policy is disabled, its future executions will be unscheduled. Defaults to `true`

<a id="nestedatt--search_criteria"></a>
### Nested Schema for `search_criteria`

Required:

- `created_before_in_months` (Number) The cleanup policy will cleanup release bundles based on how long ago they were created. For example, if this parameter is 2 then release bundles created more than 2 months ago will be cleaned up as part of the policy.
- `exclude_promoted_environments` (Set of String) A list of environments to exclude from the cleanup process. To exclude all, set to `**`. Example: `exclude_promoted_environments = ["**"]`
- `include_all_projects` (Boolean) Set this value to `true` if you want the policy to run on all Artifactory projects. The default value is `false`.

~>This attribute is relevant only on the global level, for Platform Admins.
- `included_projects` (Set of String) List of projects on which you want this policy to run. To include repositories that are not assigned to any project, enter the project key `default`.

~>This setting is relevant only on the global level, for Platform Admins.
- `release_bundles` (Set of Attributes) (see [below for nested schema](#nestedatt--release_bundles))


<a id="nestedatt--release_bundles"></a>
### Nested Schema for `release_bundles`

Required:

- `name` (String) The name of the release bundle. Set `**` to include all bundles. Example: `name = "**"`
- `project_key` (String) The project identifier associated with the release bundle. This key is obtained from the Project Settings screen. Leave the field blank to apply at a global level.

## Import

Import is supported using the following syntax:

```shell
terraform import artifactory_release_bundle_v2_cleanup_policy.my-cleanup-policy my-policy
```
